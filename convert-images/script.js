if(window.location.href.includes("convert")){const e=document.getElementById("sidebar"),t=document.getElementById("sidebarToggle"),n=document.getElementById("overlay");function toggleSidebar(){e.classList.toggle("active"),n.classList.toggle("active"),t.classList.toggle("active")}t.addEventListener("click",toggleSidebar),n.addEventListener("click",toggleSidebar);const o=document.getElementById("file-input"),a=document.getElementById("upload-section"),d=document.getElementById("converter-section"),r=document.getElementById("preview-image"),c=document.getElementById("file-name"),l=document.getElementById("reset-btn"),i=document.querySelectorAll(".format-buttons button"),s=document.getElementById("convert-btn"),u=document.getElementById("quality-box"),m=document.getElementById("quality-range"),g=document.getElementById("quality-value"),v=document.getElementById("download-section"),h=document.getElementById("download-btn");let E=null,y="png",L=null;o.addEventListener("change",(e=>{const t=e.target.files[0];if(!t||!t.type.startsWith("image/"))return;E=t;const n=new FileReader;n.onload=e=>{r.src=e.target.result},n.readAsDataURL(t),c.textContent=t.name,a.classList.add("hidden"),d.classList.remove("hidden"),v.classList.add("hidden")})),l.addEventListener("click",(()=>{o.value="",E=null,L=null,d.classList.add("hidden"),a.classList.remove("hidden"),v.classList.add("hidden")})),i.forEach((e=>{e.addEventListener("click",(()=>{i.forEach((e=>e.classList.remove("active"))),e.classList.add("active"),y=e.dataset.format,u.classList.toggle("hidden","png"===y),v.classList.add("hidden")}))})),m.addEventListener("input",(()=>{g.textContent=m.value})),s.addEventListener("click",(()=>{if(!E)return;s.textContent="Converting...",s.disabled=!0;const e=new Image;e.src=r.src,e.onload=()=>{const t=document.createElement("canvas"),n=t.getContext("2d");t.width=e.width,t.height=e.height,n.drawImage(e,0,0);const o=`image/${y}`,a="png"===y?1:m.value/100;t.toBlob((e=>{L=URL.createObjectURL(e),v.classList.remove("hidden"),s.textContent="Convert Image",s.disabled=!1}),o,a)}})),h.addEventListener("click",(()=>{if(!L)return;const e=document.createElement("a");e.href=L;const t=E.name.split(".").slice(0,-1).join(".")||"converted";e.download=t+"."+y,e.click()}))}else if(window.location.href.includes("color")){const p=(e,t,n)=>Math.max(t,Math.min(n,e));function rgbToHex(e,t,n){return"#"+[e,t,n].map((e=>e.toString(16).padStart(2,"0"))).join("")}function hexToRgb(e){3===(e=e.replace("#","")).length&&(e=e.split("").map((e=>e+e)).join(""));const t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]}function rgbToHsl(e,t,n){e/=255,t/=255,n/=255;const o=Math.max(e,t,n),a=Math.min(e,t,n);let d,r,c=(o+a)/2;if(o===a)d=r=0;else{const l=o-a;switch(r=c>.5?l/(2-o-a):l/(o+a),o){case e:d=(t-n)/l+(t<n?6:0);break;case t:d=(n-e)/l+2;break;case n:d=(e-t)/l+4}d/=6}return[Math.round(360*d),Math.round(100*r),Math.round(100*c)]}function hslToRgb(e,t,n){let o,a,d;if(e/=360,n/=100,0===(t/=100))o=a=d=n;else{const r=(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e),c=n<.5?n*(1+t):n+t-n*t,l=2*n-c;o=r(l,c,e+1/3),a=r(l,c,e),d=r(l,c,e-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*d)]}const w=document.getElementById("svCanvas"),b=document.getElementById("hueCanvas"),f=w.getContext("2d"),I=b.getContext("2d"),H=document.getElementById("colorInput"),x=document.getElementById("hexInput"),C=document.getElementById("rgbInput"),B=document.getElementById("hslInput"),S=document.getElementById("rgbaInput"),T=document.getElementById("previewBox"),k=document.getElementById("addToPalette"),R=document.getElementById("history"),M=document.getElementById("extractedPalette"),F=document.getElementById("extractedCount"),V=document.getElementById("imageFile"),$=document.getElementById("uploadCard"),U=document.getElementById("generated");document.getElementById("themeToggle");let G=217,j=80,A=60,O=1;function drawHue(){const e=I.createLinearGradient(0,0,0,b.height);for(let t=0;t<=360;t+=10)e.addColorStop(t/360,`hsl(${t},100%,50%)`);I.fillStyle=e,I.fillRect(0,0,b.width,b.height)}function drawSV(e){const t=w.width,n=w.height;f.fillStyle=`hsl(${e},100%,50%)`,f.fillRect(0,0,t,n);const o=f.createLinearGradient(0,0,t,0);o.addColorStop(0,"#fff"),o.addColorStop(1,"rgba(255,255,255,0)"),f.fillStyle=o,f.fillRect(0,0,t,n);const a=f.createLinearGradient(0,0,0,n);a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"#000"),f.fillStyle=a,f.fillRect(0,0,t,n)}function updateFromHSV(){const e=G/360,t=j/100,n=A/100;let o,a,d;const r=Math.floor(6*e),c=6*e-r,l=n*(1-t),i=n*(1-c*t),s=n*(1-(1-c)*t);switch(r%6){case 0:o=n,a=s,d=l;break;case 1:o=i,a=n,d=l;break;case 2:o=l,a=n,d=s;break;case 3:o=l,a=i,d=n;break;case 4:o=s,a=l,d=n;break;case 5:o=n,a=l,d=i}o=Math.round(255*o),a=Math.round(255*a),d=Math.round(255*d);const u=rgbToHex(o,a,d);H.value=u,x.value=u,C.value=`rgb(${o}, ${a}, ${d})`;const[m,g,v]=rgbToHsl(o,a,d);B.value=`hsl(${m}, ${g}%, ${v}%)`,S.value=`rgba(${o}, ${a}, ${d}, ${O})`,T.style.background=u,T.textContent=u.toUpperCase()}function handleHueEvent(e){const t=b.getBoundingClientRect(),n=p((e.touches?e.touches[0].clientY:e.clientY)-t.top,0,t.height)/t.height;G=Math.round(360*n),drawSV(G),updateFromHSV()}function handleSvEvent(e){const t=w.getBoundingClientRect(),n=p((e.touches?e.touches[0].clientX:e.clientX)-t.left,0,t.width),o=p((e.touches?e.touches[0].clientY:e.clientY)-t.top,0,t.height);j=Math.round(n/t.width*100),A=Math.round(100*(1-o/t.height)),updateFromHSV()}function loadHistory(){const e=localStorage.getItem("devtem_colors");return e?JSON.parse(e):[]}function saveHistory(e){localStorage.setItem("devtem_colors",JSON.stringify(e))}function renderHistory(){R.innerHTML="";loadHistory().forEach((e=>{const t=document.createElement("div");t.className="item",t.style.background=e,t.title=e,t.addEventListener("click",(()=>{setColorFromHex(e)})),R.appendChild(t)}))}function pushHistory(e){let t=loadHistory();t=t.filter((t=>t.toLowerCase()!==e.toLowerCase())),t.unshift(e),t.length>12&&(t=t.slice(0,12)),saveHistory(t),renderHistory()}function setColorFromHex(e){const[t,n,o]=hexToRgb(e),a=rgbToHsl(t,n,o);G=a[0],j=a[1],A=a[2],drawSV(G),updateFromHSV()}function generateTriadic(e){const[t,n,o]=hexToRgb(e),a=rgbToHsl(t,n,o),d=a[0],r=[e];for(let e=1;e<3;e++){const t=(d+120*e)%360,[n,o,c]=hslToRgb(t,a[1],a[2]);r.push(rgbToHex(n,o,c))}return r}function generateAnalogous(e){const[t,n,o]=hexToRgb(e),a=rgbToHsl(t,n,o),d=a[0],r=[];for(let e=-2;e<=2;e++){const t=(d+20*e+360)%360,[n,o,c]=hslToRgb(t,a[1],p(a[2]+4*e,0,100));r.push(rgbToHex(n,o,c))}return r}function generateComplementary(e){const[t,n,o]=hexToRgb(e),a=rgbToHsl(t,n,o),d=(a[0]+180)%360,[r,c,l]=hslToRgb(d,a[1],a[2]);return[e,rgbToHex(r,c,l)]}function renderGenerated(e){U.innerHTML="",e.forEach((e=>{const t=document.createElement("div");t.className="swatch",t.style.background=e,t.textContent=e.replace("#","").toUpperCase(),t.title=e,t.addEventListener("click",(()=>setColorFromHex(e))),U.appendChild(t)}))}function extractColorsFromImage(e,t=6){const n=document.createElement("canvas"),o=n.getContext("2d");let a=e.naturalWidth,d=e.naturalHeight;if(Math.max(a,d)>200){const e=200/Math.max(a,d);a=Math.round(a*e),d=Math.round(d*e)}n.width=a,n.height=d,o.drawImage(e,0,0,a,d);const r=o.getImageData(0,0,a,d).data,c={};for(let e=0;e<r.length;e+=4){const t=r[e],n=r[e+1],o=r[e+2];if(r[e+3]<125)continue;const a=(t>>4&15)<<8|(n>>4&15)<<4|o>>4&15;c[a]=(c[a]||0)+1}return Object.entries(c).sort(((e,t)=>t[1]-e[1])).slice(0,t).map((([e])=>{const t=parseInt(e);return rgbToHex((t>>8&15)<<4,(t>>4&15)<<4,(15&t)<<4)}))}drawHue(),drawSV(G),updateFromHSV(),b.addEventListener("mousedown",(e=>{handleHueEvent(e);const t=e=>handleHueEvent(e),n=()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",n)};window.addEventListener("mousemove",t),window.addEventListener("mouseup",n)})),b.addEventListener("touchstart",(e=>{handleHueEvent(e);const t=e=>handleHueEvent(e),n=()=>{window.removeEventListener("touchmove",t),window.removeEventListener("touchend",n)};window.addEventListener("touchmove",t),window.addEventListener("touchend",n)})),w.addEventListener("mousedown",(e=>{handleSvEvent(e);const t=e=>handleSvEvent(e),n=()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",n)};window.addEventListener("mousemove",t),window.addEventListener("mouseup",n)})),w.addEventListener("touchstart",(e=>{handleSvEvent(e);const t=e=>handleSvEvent(e),n=()=>{window.removeEventListener("touchmove",t),window.removeEventListener("touchend",n)};window.addEventListener("touchmove",t),window.addEventListener("touchend",n)})),H.addEventListener("input",(e=>{const t=e.target.value,[n,o,a]=hexToRgb(t),d=rgbToHsl(n,o,a);G=d[0],j=d[1],A=d[2],drawSV(G),updateFromHSV()})),x.addEventListener("change",(e=>{let t=e.target.value.trim();t.startsWith("#")||(t="#"+t);try{const[e,n,o]=hexToRgb(t),a=rgbToHsl(e,n,o);G=a[0],j=a[1],A=a[2],drawSV(G),updateFromHSV()}catch(e){console.error("Invalid hex value")}})),document.querySelectorAll(".copy-btn").forEach((e=>e.addEventListener("click",(async()=>{const t=e.dataset.copy;let n="";"hex"===t&&(n=x.value),"rgb"===t&&(n=C.value),"hsl"===t&&(n=B.value),"rgba"===t&&(n=S.value);try{await navigator.clipboard.writeText(n),e.textContent="Copied",setTimeout((()=>e.textContent="Copy"),900)}catch(e){alert("Copy failed â€” try manually")}})))),document.getElementById("copyHexLarge").addEventListener("click",(()=>{navigator.clipboard.writeText(x.value).then((()=>alert("HEX copied")))})),document.getElementById("copyRgbLarge").addEventListener("click",(()=>{navigator.clipboard.writeText(C.value).then((()=>alert("RGB copied")))})),document.getElementById("clearHistory").addEventListener("click",(()=>{localStorage.removeItem("devtem_colors"),renderHistory()})),renderHistory(),k.addEventListener("click",(()=>{pushHistory(x.value)})),document.getElementById("generateTriadic").addEventListener("click",(()=>{renderGenerated(generateTriadic(x.value))})),document.getElementById("generateAnalogous").addEventListener("click",(()=>{renderGenerated(generateAnalogous(x.value))})),document.getElementById("generateComplementary").addEventListener("click",(()=>{renderGenerated(generateComplementary(x.value))})),V.addEventListener("change",(e=>{const t=e.target.files[0];if(!t)return;const n=URL.createObjectURL(t),o=new Image;o.crossOrigin="Anonymous",o.onload=function(){const e=extractColorsFromImage(o,8);M.innerHTML="",e.forEach((e=>{const t=document.createElement("div");t.className="swatch",t.style.background=e,t.textContent="",t.title=e,t.addEventListener("click",(()=>{setColorFromHex(e),pushHistory(e)})),M.appendChild(t)})),F.textContent=e.length+" colors",URL.revokeObjectURL(n)},o.src=n})),$.addEventListener("click",(()=>V.click())),renderGenerated([x.value]);const q=document.getElementById("sidebarToggle"),N=document.getElementById("sidebar"),Y=document.getElementById("overlay");q.addEventListener("click",(()=>{N.classList.toggle("active"),Y.classList.toggle("active")})),Y.addEventListener("click",(()=>{N.classList.remove("active"),Y.classList.remove("active")})),renderHistory(),updateFromHSV()}else console.log(decodeURIComponent("%20page%20not%20found%20"));
