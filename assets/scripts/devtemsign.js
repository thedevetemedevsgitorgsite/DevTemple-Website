import{createClient}from"https://esm.sh/@supabase/supabase-js@2";const btnDr=document.getElementById("btttn");btnDr&&(window.addEventListener("scroll",(function(){window.pageYOffset>=300?btnDr.style.display="block":btnDr.style.display="none"})),btnDr.addEventListener("click",(function(){window.scrollTo({top:0,behavior:"smooth"})})));const res=await fetch("/.netlify/functions/fcnfig");const{url,key}=await res.json();export const supabase=createClient(url,key);  document.getElementById("submitable").addEventListener("submit",(async e=>{e.preventDefault();const a=document.querySelector("#signEmail").value,r=document.querySelector("#signPsw").value,t=document.querySelector("#signFullName").value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),s=document.querySelector("#signUserName")?.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")||t.replace(/\s*/,"_").toLowerCase(),l=document.querySelector("#signBio").value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),o=document.querySelector("#signSkill").value,c=document.querySelector("#signImg");try{const{data:e,error:n}=await supabase.auth.signUp({email:a,password:r});if(n)throw n;const u=e.user;let i="https://placehold.co/100x100";if(c.files.length>0){const e=c.files[0],a=`avatars/${u.id}_${Date.now()}_${e.name}`,{error:r}=await supabase.storage.from("avatars").upload(a,e);if(r)console.error("Upload failed:",r.message);else{const{data:e}=supabase.storage.from("avatars").getPublicUrl(a);i=e.publicUrl}}const{error:g}=await supabase.from("profiles").insert([{id:u.id,username:s,full_name:t,bio:l,skills:o,email:a,photo_url:i,created_at:new Date}]);if(g)throw g;cAlert("✅ Signup successful!","success","Success"),window.location.href="/dashboard"}catch(e){cAlert("❌ Error: "+e.message,"warning","Error")}})),document.querySelector("#haveAcct form").addEventListener("submit",(async e=>{e.preventDefault();const a=document.querySelector("#logEmail").value,r=document.querySelector("#logPsw").value;try{const{error:e}=await supabase.auth.signInWithPassword({email:a,password:r});if(e)throw e;cAlert("✅ Logged in successfully!","success","Logged in"),window.location.href="/dashboard"}catch(e){cAlert("❌ Login failed: "+e.message,"warning","Error")}}));
